//
// Created by stramek on 25.08.17.
//

#include <include/planeG2O/MatchPlanesG2o.h>
#include "include/planeG2O/GlobalG2oMap.h"

double  pointSlamX[] ={0,0.00462061,-0.0027874,0.00735143,0.0110993,-0.00820089,0.00883692,0.00372272,0.00352543,-0.00727622,-0.00543342,0.00402842,-0.00263219,-0.00357987,-0.0100788,-0.0044248,0.00880386,-0.00636603,0.00975245,0.0157193,0.00245458,0.00302506,-0.0010051,-0.011722,-0.00153948,-0.00768526,0.0026406,-0.0118462,-0.00364462,-0.0071334,-0.0229451,-0.00177096,-0.00750677,-0.00167,-0.0138752,-0.0136334,-0.00929463,-0.0110135,-0.0147632,-0.0142588,-0.0154605,-0.0172832,-0.00703776,-0.0162043,-0.0147068,-0.0200631,-0.0206539,-0.0168921,-0.0210094,-0.0294953,-0.019031,-0.0120215,-0.0151816,-0.0159253,-0.00892899,-0.00353094,-0.00444015,-0.00292713,0.00121186,0.00169554,0.0101773,0.0142151,0.0285784,0.0245875,0.0349195,0.033416,0.037021,0.0380984,0.0483227,0.0597968,0.0521731,0.0721708,0.061298,0.0785446,0.0721742,0.0758768,0.0874764,0.0897236,0.0938793,0.0935917,0.0988224,0.097635,0.0999972,0.100444,0.107988,0.111202,0.109297,0.113685,0.111281,0.1233,0.12045,0.127509,0.122316,0.122514,0.123037,0.128656,0.13192,0.141732,0.130955,0.136341,0.142142,0.138205,0.142314,0.150919,0.144147,0.143875,0.142651,0.141244,0.148633,0.153222,0.152428,0.158629,0.161134,0.156566,0.157046,0.147916,0.150479,0.156718,0.156386,0.156798,0.145212,0.15931,0.165219,0.159984,0.147692,0.158771,0.155102,0.159125,0.159832,0.154657,0.149732,0.15764,0.162967,0.160201,0.16257,0.162005,0.163598,0.164579,0.170223,0.170747,0.170299,0.169522,0.164068,0.157188,0.162567,0.149887,0.146238,0.155782,0.146924,0.14862,0.142915,0.14365,0.124897,0.126208,0.1123,0.110253,0.109158,0.0895322,0.106296,0.0795414,0.0826438,0.077416,0.0671634,0.058212,0.0539541,0.0280984,0.091291,0.0459635,0.0389474,0.0369189,0.024608,0.0238634,0.0269913,0.0220798,0.0143619,0.0143873,0.0141007,0.0105671,0.00930829,0.0121508,0.00621664,-0.00145517,-0.000975557,-0.00200624,-0.0161185,-0.00822398,-0.0126078,-0.00546795,-0.0193457,-0.0211586,-0.0150051,-0.00970883,-0.0103141,-0.0168071,-0.0150275,-0.0149484,-0.0109836,-0.0132446,-0.0152468,-0.0158376,-0.018156,-0.018787,-0.019904,-0.0136981,-0.0103342,-0.0142474,-0.0176365,-0.0224341,-0.0236146,-0.0201074,-0.0223106,-0.0230951,-0.0211066,-0.0213392,-0.0158272,-0.0265299,-0.0304943,-0.0187924,-0.0234159,-0.0232592,-0.0363367,-0.0298581,-0.0281316,-0.0291795,-0.0343745,-0.0308194,-0.0289201,-0.0414871,-0.042577,-0.0342659,-0.0462156,-0.0418516,-0.0525218,-0.0507463,-0.0546832,-0.0495468,-0.059978,-0.0626626,-0.0673519,-0.0730328,-0.0683777,-0.0867887,-0.0795505,-0.0854894,-0.0923553,-0.0954902,-0.0967654,-0.0988354,-0.0946661,-0.113565,-0.112014,-0.115537,-0.115396,-0.119701,-0.12146,-0.123866,-0.126133,-0.131907,-0.134646,-0.139274,-0.14029,-0.147068,-0.144483,-0.154678,-0.15253,-0.156677,-0.154742,-0.163189,-0.165039,-0.162968,-0.177457,-0.172151,-0.179365,-0.179302,-0.182339,-0.184366,-0.189258,-0.190099,-0.190505,-0.192696,-0.191547,-0.197484,-0.201558,-0.206251,-0.211035,-0.20914,-0.218276,-0.220457,-0.227632,-0.232699,-0.242547,-0.245708,-0.254417,-0.259715,-0.265607,-0.273734,-0.284547,-0.291534,-0.295414,-0.303757,-0.312972,-0.321576,-0.33286,-0.338471,-0.345881,-0.349844,-0.360258,-0.367582,-0.381265,-0.390509,-0.397241,-0.404315,-0.410373,-0.422541,-0.431499,-0.434719,-0.445255,-0.450506,-0.45711,-0.467965,-0.468907,-0.475046,-0.480969,-0.48839,-0.48847,-0.494058,-0.498883,-0.505974,-0.508513,-0.513146,-0.51923,-0.521903,-0.527181,-0.533485,-0.534637,-0.538916,-0.542845,-0.549186,-0.551021,-0.555213,-0.559844,-0.566491,-0.568623,-0.573128,-0.573854,-0.579179,-0.581781,-0.587976,-0.586351,-0.59122,-0.590115,-0.590227,-0.595987,-0.604288,-0.600676,-0.608913,-0.606942,-0.609278,-0.611809,-0.607471,-0.612454,-0.617197,-0.618467,-0.618753,-0.619037,-0.619532,-0.618863,-0.620574,-0.624339,-0.623297,-0.625579,-0.626818,-0.628038,-0.632397,-0.639063,-0.636256,-0.636617,-0.643563,-0.644239,-0.642323,-0.655007,-0.646235,-0.654215,-0.65476,-0.656733,-0.66791,-0.665254,-0.672984,-0.683453,-0.685769,-0.689692,-0.687084,-0.692353,-0.700226,-0.706476,-0.708693,-0.716032,-0.713216,-0.720804,-0.719102,-0.725372,-0.729256,-0.731916,-0.730687,-0.731423,-0.739603,-0.746438,-0.748501,-0.742274,-0.7464,-0.746636,-0.748862,-0.74959,-0.74885,-0.750979,-0.754952,-0.757654,-0.753848,-0.756053,-0.767947,-0.753859,-0.763447,-0.761822,-0.764147,-0.7587,-0.761414,-0.757737,-0.752643,-0.755284,-0.749563,-0.752785,-0.753055,-0.755207,-0.751824,-0.750111,-0.747025,-0.746635,-0.738525,-0.739008,-0.732874,-0.731376,-0.731126,-0.731362,-0.730722,-0.730182,-0.730805,-0.726379,-0.727461,-0.730528,-0.727192,-0.728864,-0.726607,-0.730517,-0.733303,-0.733821,-0.738783,-0.733913,-0.74241,-0.749675,-0.747962,-0.750524,-0.747592,-0.752109,-0.753108,-0.760841,-0.76004,-0.766223,-0.76872,-0.771735,-0.77651,-0.779216,-0.783527,-0.786619,-0.785937,-0.793067,-0.794333,-0.800376,-0.807246,-0.804245,-0.811326,-0.816858,-0.818714,-0.819968,-0.818502,-0.822254,-0.820566,-0.821707,-0.824097,-0.826811,-0.828031,-0.825006,-0.827628,-0.824874,-0.829688,-0.832688,-0.835223,-0.827609,-0.827696,-0.823781,-0.826744,-0.831829,-0.829376,-0.825443,-0.825943,-0.825475,-0.828885,-0.826263,-0.820789,-0.825246,-0.823602,-0.821681,-0.815642,-0.813039,-0.805587,-0.796062,-0.795257,-0.786762,-0.783102,-0.776325,-0.772167,-0.77329,-0.770384,-0.773085,-0.765819,-0.766705,-0.764173,-0.76242,-0.763721,-0.758757,-0.75843,-0.755689,-0.753526,-0.748701,-0.751611,-0.749021,-0.749019,-0.752124,-0.744177,-0.743806,-0.746324,-0.745044,-0.753017,-0.75333,-0.749006,-0.753668,-0.750616,-0.756942,-0.754571,-0.758799,-0.759666,-0.759767,-0.764246,-0.765354,-0.768154,-0.76892,-0.769345,-0.766832,-0.768465,-0.76973,-0.769122,-0.77064,-0.770468,-0.770091,-0.77385,-0.771262,-0.77419,-0.775665,-0.776227,-0.779537,-0.775502,-0.777385,-0.777745,-0.778216,-0.778602,-0.77732,-0.77463,-0.778179,-0.777619,-0.778264,-0.775799,-0.774872,-0.770963,-0.771639,-0.769451,-0.770791,-0.76789,-0.766695,-0.766196,-0.765984,-0.766923,-0.767053,-0.768526,-0.769693,-0.767061,-0.769808,-0.770199,-0.76963,-0.769993,-0.768828,-0.769748,-0.764691,-0.767578,-0.767238,-0.768345,-0.767067,-0.767444,-0.765865,-0.766287,-0.764043,-0.76345,-0.762263,-0.760034,-0.757054,-0.763361,-0.764795,-0.757704,-0.75738,-0.757118,-0.753863,-0.749974,-0.74796,-0.746783,-0.743212,-0.736401,-0.73335,-0.72988,-0.72603,-0.71726,-0.715836,-0.709983,-0.706251,-0.696355,-0.691509,-0.683959,-0.680576,-0.671935,-0.665442,-0.656925,-0.649003,-0.641065,-0.634595,-0.625263,-0.617614,-0.607626,-0.600961,-0.591681,-0.583806,-0.57504,-0.564536,-0.560747,-0.550729,-0.542147,-0.52458,-0.518408,-0.508576,-0.50133,-0.493228,-0.48605,-0.47505,-0.467043,-0.455709,-0.452543,-0.442755,-0.436201,-0.429041,-0.420144,-0.408263,-0.402749,-0.39838,-0.387886,-0.380638,-0.371027,-0.365803,-0.355897,-0.345474,-0.33881,-0.331,-0.321667,-0.309902,-0.305636,-0.297003,-0.285258,-0.276227,-0.269959,-0.25659,-0.248848,-0.242392,-0.231214,-0.222313,-0.211104,-0.202446,-0.1928,-0.181475,-0.172076,-0.163551,-0.14233,-0.134103,-0.120366,-0.114368,-0.107781,-0.0993803,-0.0942641,-0.0846953,-0.0787163,-0.0725697,-0.0650703,-0.0591455,-0.0497308,-0.0403202,-0.0329907,-0.0267026,-0.0205806,-0.0107829,-0.00163223,0.00877593,0.0154967,0.0238033,0.03357,0.0403794,0.0521998,0.0656461,0.0759804,0.0842209,0.0965322,0.109034,0.122732,0.131503,0.14384,0.151613,0.165328,0.174336,0.186923,0.197207,0.208562,0.217377,0.22648,0.236469,0.247386,0.25268,0.259419,0.265855,0.272601,0.282805,0.287919,0.296128,0.300766,0.313943,0.319053,0.324776,0.331649,0.337778,0.345976,0.349514,0.356241,0.357968,0.363047,0.370352,0.381546,0.384611,0.390907,0.398111,0.405749,0.414681,0.421786,0.424511,0.44033,0.443299,0.449208,0.457504,0.466302,0.468554,0.481773,0.479646,0.4887,0.496102,0.496279,0.499115,0.50779,0.512125,0.513947,0.517908,0.520102,0.524055,0.52427,0.526867,0.532464,0.529936,0.537657,0.539543,0.543133,0.544002,0.548907,0.551998,0.555933,0.557468,0.557569,0.559548,0.563614,0.563369,0.565581,0.568475,0.569199,0.573024,0.57581,0.57842,0.579354,0.579498,0.584972,0.58801,0.590288,0.594523,0.595287,0.599912,0.60091,0.605465,0.607321,0.608575,0.609994,0.60954,0.615134,0.613129,0.612221,0.612921,0.611952,0.610012,0.613975,0.612036,0.613037,0.607148,0.601181,0.600429,0.601611,0.603269,0.595607,0.591474,0.596014,0.59328,0.584261,0.585734,0.572621,0.574128,0.56037,0.563927,0.572724,0.562666,0.557931,0.549515,0.549166,0.546497,0.545746,0.537002,0.53005,0.531754,0.527615,0.523005,0.521745,0.516806,0.520771,0.508351,0.504889,0.501507,0.495997,0.491728,0.484936,0.476303,0.471833,0.46394,0.457736,0.447782,0.442976,0.429462,0.423421,0.415551,0.40528,0.395972,0.386286,0.370359,0.363673,0.356024,0.346557,0.335287,0.325124,0.319066,0.30772,0.297824,0.289223,0.283379,0.27742,0.263924,0.25737,0.250655,0.244118,0.232102,0.22797,0.220843,0.215342,0.20148,0.200739,0.190956,0.190117,0.177571,0.171633,0.159807,0.158616,0.143175,0.132549,0.124334,0.117538,0.114649,0.112331,0.0988534,0.107277,0.0750447,0.0669391,0.0715234,0.0462756,0.0538647,0.0424745,0.032419,0.0451834,0.0235511,0.0154899,0.0236187,0.0224826,0.0163883,0.00190819,0.00822277,0.00906697,-0.00162113,0.000655539,-0.0148282,-0.00604625,-0.0070275,-0.00409267,-0.0101484,-0.0112343,-0.00652187,-0.0195484,-0.00962798,0.00735227,-0.0124707,-0.0131339,-0.0103043,-0.0230942,-0.0152134,-0.00965857,-0.00752283,0.018553,0.01533,-0.00515413,-0.0273908,-0.00790386,-0.00911948,-0.0146373,0.0312509,0.00957322,-0.00300834,0.00491062,0.0147549,0.0168262,0.0244948,0.00740043,0.000762544,0.0115988,0.00124515};
double  pointSlamY[] ={0,0.0157566,0.0086609,0.0150025,0.0231299,0.0140208,0.0139129,0.0221066,0.0163877,0.0139263,0.0125145,0.00957986,0.0132912,0.00708046,0.00791987,0.00912044,0.0101063,0.00852493,0.00846126,0.0185059,0.0170555,0.0179062,0.0167279,0.00097018,0.0171552,0.00776261,0.0109594,0.00296245,0.00500461,0.0121554,0.00135721,0.0115339,0.0100926,0.0130958,0.0102306,0.0118339,0.0183321,0.0283094,0.0218859,0.0129889,0.00910121,0.0161835,0.0167328,0.0218384,0.0158723,0.0203135,0.023812,0.0170637,0.030281,0.0262149,0.0261001,0.0339564,0.0257089,0.0237775,0.0315212,0.0266341,0.0199805,0.021601,0.0241822,0.0203554,0.0296089,0.0224622,0.0207649,0.0179703,0.0274157,0.0168818,0.0177831,0.0171225,0.0239455,0.0110064,0.0211585,0.0255122,0.0173093,0.01182,0.0219773,0.0237227,0.0176567,0.0153647,0.0257944,0.0218149,0.0257995,0.020232,0.0165759,0.0147845,0.0239675,0.0180448,0.0132882,0.0167996,0.0175683,0.00899553,0.0122045,0.0226322,0.0161968,0.00892505,0.0165982,0.00942542,0.00916381,0.00271546,0.0041336,-0.00533791,-0.00792232,-0.0150662,-0.00980605,-0.0149331,-0.0132372,-0.012376,-0.0210101,-0.0101711,-0.0133461,-0.0311595,-0.0219617,-0.0381453,-0.0386587,-0.0385472,-0.0320024,-0.0241366,-0.0275812,-0.0399863,-0.0427898,-0.0282581,-0.0246159,-0.0210143,-0.0397467,-0.0344319,-0.0358746,-0.0400433,-0.0485352,-0.0575699,-0.0482461,-0.037532,-0.0475232,-0.050168,-0.0418732,-0.0475278,-0.0448296,-0.0493812,-0.0523323,-0.0486967,-0.0494782,-0.0501104,-0.0478282,-0.0453572,-0.0487379,-0.0532538,-0.0434357,-0.0468278,-0.0416218,-0.0395841,-0.0410479,-0.0431968,-0.0388583,-0.0338305,-0.0441063,-0.039404,-0.040256,-0.0365818,-0.0380218,-0.0382874,-0.0368235,-0.0383074,-0.0373287,-0.0322125,-0.0385313,-0.033974,-0.0394525,-0.0535814,-0.0221448,-0.0348214,-0.0377469,-0.0425834,-0.0492173,-0.0276008,-0.029572,-0.0389222,-0.0358843,-0.0147186,-0.0276791,-0.01901,-0.0304911,-0.0324759,-0.0318677,-0.0267402,-0.0241714,-0.0131402,-0.0259993,-0.0344812,-0.0121029,-0.0460146,-0.0238777,-0.0238161,-0.0239612,-0.0225834,-0.0131574,-0.0137924,-0.0305621,-0.0571033,-0.0132001,-0.00864138,-0.0133425,-0.0210677,-0.0313721,-0.0177146,-0.0131603,-0.00735594,-0.0150135,-0.00810104,-0.0102688,-0.0168459,-0.0174155,-0.0133099,-0.0115059,-0.0171651,-0.0105089,-0.0114778,-0.0134752,-0.0172905,-0.0177851,-0.014606,-0.0203232,-0.0182605,-0.015375,-0.0201787,-0.0151782,-0.0263842,-0.019928,-0.0259665,-0.0228878,-0.0332864,-0.0318842,-0.0319055,-0.0293516,-0.0312171,-0.0233362,-0.0276329,-0.039452,-0.0343757,-0.0388626,-0.0445345,-0.0469871,-0.0484086,-0.0459909,-0.0549942,-0.056965,-0.0533388,-0.0669302,-0.0610128,-0.0572181,-0.0659556,-0.0674612,-0.0728203,-0.071088,-0.0820632,-0.0823119,-0.0863437,-0.086509,-0.0936787,-0.0949103,-0.0946036,-0.0994154,-0.099203,-0.100517,-0.103609,-0.10386,-0.106644,-0.112139,-0.108992,-0.108485,-0.113528,-0.112246,-0.114707,-0.118182,-0.1129,-0.115442,-0.112788,-0.114052,-0.115821,-0.113709,-0.117191,-0.11805,-0.119149,-0.117586,-0.119034,-0.118193,-0.118542,-0.116676,-0.117673,-0.115585,-0.109193,-0.110751,-0.109154,-0.106336,-0.107809,-0.101776,-0.107442,-0.102981,-0.103168,-0.104261,-0.0980919,-0.0974812,-0.0959037,-0.102373,-0.100473,-0.0990944,-0.102007,-0.101391,-0.101224,-0.0940279,-0.101594,-0.0974972,-0.0959944,-0.092185,-0.0947704,-0.0955473,-0.0869381,-0.0867572,-0.0789,-0.0785457,-0.0762701,-0.0809267,-0.0756773,-0.0716256,-0.0678652,-0.068906,-0.061793,-0.0617282,-0.0611369,-0.0552311,-0.0580846,-0.0519079,-0.0511079,-0.0445991,-0.0437304,-0.0445607,-0.0360776,-0.0400625,-0.0388032,-0.0388797,-0.0399392,-0.0366203,-0.0397265,-0.0339573,-0.0358475,-0.0343218,-0.0350663,-0.0355983,-0.0327913,-0.0320282,-0.0287665,-0.0273263,-0.0230571,-0.0219943,-0.0204521,-0.0212925,-0.021203,-0.0182497,-0.0173891,-0.0194877,-0.0145065,-0.0103806,-0.00874798,-0.00941731,-0.00652262,-0.00323792,-0.0048371,-0.00367076,-0.000594907,-0.000419941,0.00642395,0.00237138,0.00104249,-0.00021929,0.00104265,0.00478308,0.00466143,0.00504995,0.00466432,0.011132,0.00842404,0.0109261,0.0127524,0.0116105,0.0131784,0.0132624,0.0139284,0.0115742,0.0167719,0.0117691,0.00802043,0.00910686,0.0102288,0.00302168,0.005904,0.00925709,0.00444236,0.00232387,-0.00362367,0.00134198,0.00242126,-0.00368052,0.000800808,-0.00201535,-0.0014935,-0.00500551,-0.00433479,-0.00665222,-0.00584,-0.011124,-0.0090613,-0.0108617,-0.0113589,-0.016154,-0.0148239,-0.0127361,-0.0164628,-0.0143677,-0.0154917,-0.0162615,-0.0237555,-0.0217098,-0.0229935,-0.0229623,-0.0240456,-0.0273018,-0.0282255,-0.0273782,-0.0262258,-0.0288703,-0.0324913,-0.0274814,-0.0301425,-0.0304309,-0.0331469,-0.0314484,-0.040264,-0.0349394,-0.0360116,-0.0379027,-0.0358774,-0.0427932,-0.0387187,-0.041216,-0.037525,-0.0358737,-0.0349374,-0.0379701,-0.0384754,-0.0387171,-0.0357357,-0.0348779,-0.0345518,-0.0298595,-0.0251967,-0.026153,-0.02666,-0.0313526,-0.0299895,-0.0354155,-0.0340803,-0.032152,-0.0357092,-0.0283611,-0.0285353,-0.0274704,-0.0281326,-0.0329632,-0.035089,-0.037106,-0.0386137,-0.0463673,-0.0427936,-0.0452857,-0.04568,-0.0427945,-0.0512832,-0.0537008,-0.0597795,-0.0670668,-0.0699754,-0.0740443,-0.0718766,-0.0769962,-0.0771557,-0.0743867,-0.0778243,-0.0769253,-0.0831575,-0.0806919,-0.0807819,-0.0807975,-0.0840285,-0.0864303,-0.084792,-0.090456,-0.0865636,-0.0872488,-0.0816284,-0.0784748,-0.0778565,-0.0795571,-0.072039,-0.0682682,-0.0683153,-0.0698262,-0.0750809,-0.0768081,-0.0727811,-0.0725534,-0.0704134,-0.0749388,-0.0687253,-0.075291,-0.0789861,-0.0784253,-0.073908,-0.0713491,-0.0746769,-0.0738083,-0.0752895,-0.0747817,-0.0788309,-0.0830472,-0.0824736,-0.0860475,-0.0840018,-0.0843042,-0.0843199,-0.0856211,-0.0800879,-0.0797175,-0.0805268,-0.076695,-0.0753586,-0.0711679,-0.0679421,-0.0667548,-0.0642577,-0.0639416,-0.0570663,-0.0579743,-0.057487,-0.0540835,-0.0500019,-0.0461974,-0.0415749,-0.0373557,-0.0301639,-0.0291018,-0.0182314,-0.0163002,-0.0150694,-0.0125665,-0.00566946,-0.00424672,-0.00877302,-0.00675729,-0.000708921,0.000663016,0.00286947,0.00226542,0.0042724,0.00611974,0.00679356,0.00701913,0.00725539,0.00933395,0.0135467,0.0149203,0.0128521,0.0161973,0.0186476,0.0203017,0.0216772,0.0241501,0.0265381,0.032902,0.0330136,0.0365921,0.0439168,0.0420178,0.0471328,0.0463781,0.0470086,0.0505193,0.0526839,0.0536169,0.054758,0.0579739,0.0571,0.0585669,0.0636781,0.065695,0.0679812,0.0670158,0.0703557,0.0729325,0.0753017,0.0758322,0.0795585,0.084741,0.0833916,0.0886219,0.0909864,0.0934138,0.0917506,0.0950273,0.0970139,0.0966321,0.101543,0.104334,0.106627,0.106235,0.102723,0.10294,0.10728,0.117311,0.116315,0.117561,0.119698,0.118924,0.115041,0.118361,0.121296,0.123529,0.120288,0.122164,0.12456,0.124718,0.118534,0.118893,0.120407,0.119245,0.114686,0.118218,0.118806,0.117974,0.117625,0.120277,0.119026,0.119876,0.118735,0.117048,0.11792,0.116573,0.118332,0.116113,0.115797,0.116612,0.117665,0.114005,0.11132,0.114197,0.112425,0.112262,0.113208,0.108506,0.114583,0.112529,0.109878,0.114363,0.109933,0.11262,0.112129,0.116196,0.120482,0.124544,0.126642,0.127719,0.131797,0.128944,0.13243,0.135969,0.137689,0.134992,0.136927,0.139333,0.140737,0.14187,0.144651,0.143782,0.142932,0.147898,0.146127,0.148612,0.153257,0.158187,0.1577,0.156886,0.159553,0.155593,0.153371,0.15228,0.15722,0.158046,0.15931,0.162505,0.159807,0.164826,0.165233,0.168554,0.170796,0.176151,0.174213,0.175854,0.177106,0.180449,0.178393,0.177373,0.180063,0.18026,0.180305,0.182393,0.186443,0.184158,0.180669,0.180586,0.18066,0.179586,0.181619,0.18503,0.17766,0.18179,0.174699,0.17595,0.176116,0.175944,0.173678,0.169179,0.170456,0.173945,0.170808,0.168024,0.163517,0.165306,0.165659,0.166831,0.166061,0.164948,0.168938,0.170063,0.169223,0.166918,0.168544,0.166005,0.163334,0.161388,0.165986,0.163605,0.166468,0.161005,0.159956,0.158573,0.160863,0.159338,0.157019,0.16112,0.165253,0.162201,0.160582,0.163164,0.1643,0.164522,0.164724,0.16337,0.162979,0.162087,0.159848,0.161059,0.158667,0.157609,0.164633,0.162114,0.160815,0.160948,0.159926,0.15892,0.162183,0.156513,0.150053,0.151759,0.150234,0.148015,0.148876,0.150814,0.151397,0.151166,0.14496,0.144772,0.143133,0.141658,0.140642,0.135946,0.134088,0.130301,0.130418,0.125821,0.125515,0.121156,0.123598,0.121877,0.119714,0.120735,0.117466,0.116857,0.113918,0.115403,0.115297,0.11791,0.111198,0.113978,0.114993,0.118028,0.112421,0.113866,0.115758,0.112687,0.113897,0.112996,0.113111,0.115267,0.113928,0.114086,0.116724,0.114609,0.119185,0.112513,0.111412,0.124931,0.123276,0.123524,0.117183,0.128221,0.128345,0.123343,0.12119,0.122396,0.121856,0.121793,0.130233,0.121221,0.133313,0.125833,0.131105,0.137912,0.127245,0.135516,0.122404,0.138947,0.127452,0.139725,0.130762,0.131211,0.126457,0.126158,0.134205,0.131973,0.134724,0.13941,0.138365,0.136221,0.144445,0.140213,0.13857,0.133061,0.136943,0.140191,0.131547,0.131064,0.125148,0.129421,0.128225,0.127484,0.125608,0.12711,0.117907,0.119521,0.116285,0.119314,0.117017,0.108109,0.106155,0.107669,0.11424,0.104507,0.104692,0.102644,0.102701,0.108115,0.0979737,0.0928067,0.0934788,0.0889582,0.0905251,0.0940364,0.0921835,0.086924,0.0977487,0.101202,0.0892865,0.0831126,0.077708,0.0769871,0.0821479,0.0779695,0.0698345,0.0792089,0.0724368,0.0664005,0.0938731,0.0323779,0.0952407,0.0935364,0.0913894,0.0455544,0.0848369,0.0981796,0.0638097,0.0707873,0.0926182,0.0698835,0.100827,0.0794071,0.0683341,0.104168,0.122334,0.10705,0.0592707,0.0770649,0.078477,0.0503013,0.0562693,0.0799752,0.0758356,0.0533241,0.076189,0.0738033,0.104165,0.101821,0.078148,0.0474882,0.106468,0.0834834,0.0579242,0.063321,0.135581,0.0942026,0.0315588,0.0910225,0.0119601,-0.0387263,0.0351789,0.0800486,0.0630156,0.0814409,0.0391039,-0.0867258,0.0316437,-0.0133843,0.0393789,0.00175067,0.000651931,-0.00929917,0.0535691,0.113409,0.05149,0.055562};
double  pointSlamZ[] ={-2.5,-2.49946,-2.49957,-2.50016,-2.49474,-2.5035,-2.49293,-2.50178,-2.4985,-2.50227,-2.4988,-2.50023,-2.49769,-2.49847,-2.4979,-2.49835,-2.49464,-2.50224,-2.49783,-2.49205,-2.49982,-2.49788,-2.49864,-2.50159,-2.49696,-2.50432,-2.49823,-2.50121,-2.49986,-2.49453,-2.50319,-2.49388,-2.49795,-2.50038,-2.50093,-2.49815,-2.49829,-2.49595,-2.49884,-2.4945,-2.49662,-2.49096,-2.48759,-2.48562,-2.48502,-2.48455,-2.48069,-2.47712,-2.46894,-2.46415,-2.45555,-2.44904,-2.44608,-2.43842,-2.42895,-2.42332,-2.412,-2.40593,-2.3973,-2.38752,-2.37991,-2.36996,-2.3546,-2.34705,-2.3395,-2.33132,-2.31722,-2.31311,-2.30115,-2.29246,-2.28309,-2.27132,-2.26887,-2.25487,-2.24873,-2.24202,-2.23001,-2.21914,-2.2118,-2.20572,-2.19606,-2.19026,-2.18194,-2.1742,-2.15992,-2.15047,-2.14138,-2.13292,-2.12588,-2.11394,-2.10672,-2.08887,-2.08467,-2.07473,-2.06151,-2.04987,-2.03918,-2.02966,-2.0179,-2.00819,-1.99242,-1.98788,-1.97014,-1.96403,-1.95463,-1.94524,-1.93876,-1.93101,-1.91734,-1.91097,-1.90474,-1.89107,-1.88173,-1.88126,-1.86816,-1.85741,-1.85253,-1.84118,-1.82629,-1.82153,-1.81973,-1.80132,-1.79046,-1.77908,-1.77336,-1.75776,-1.74654,-1.73843,-1.72505,-1.71904,-1.71049,-1.70197,-1.69137,-1.68179,-1.67661,-1.66798,-1.65701,-1.6516,-1.63797,-1.62424,-1.61354,-1.61177,-1.60494,-1.59672,-1.58791,-1.59046,-1.58554,-1.56923,-1.56584,-1.5594,-1.54719,-1.53838,-1.54482,-1.52858,-1.51636,-1.50428,-1.49928,-1.50186,-1.46999,-1.49258,-1.4734,-1.46615,-1.4688,-1.46842,-1.45899,-1.4666,-1.39167,-1.43424,-1.43119,-1.39975,-1.40513,-1.43137,-1.40873,-1.38599,-1.39548,-1.40046,-1.38624,-1.39872,-1.37693,-1.38211,-1.38831,-1.39459,-1.38495,-1.38484,-1.39148,-1.35058,-1.36212,-1.36152,-1.36057,-1.35316,-1.36396,-1.34241,-1.37012,-1.33813,-1.32627,-1.30428,-1.34194,-1.33429,-1.31292,-1.29421,-1.3234,-1.31221,-1.32068,-1.31698,-1.32359,-1.31421,-1.31819,-1.31328,-1.31261,-1.31611,-1.3158,-1.31899,-1.32156,-1.31969,-1.33114,-1.32184,-1.32169,-1.33095,-1.33246,-1.33285,-1.3259,-1.3339,-1.33709,-1.34508,-1.34039,-1.35198,-1.35363,-1.35102,-1.35322,-1.3646,-1.36066,-1.36689,-1.36668,-1.37378,-1.3746,-1.38179,-1.39093,-1.39483,-1.39691,-1.39963,-1.40876,-1.40682,-1.41916,-1.41643,-1.42217,-1.42475,-1.43444,-1.43987,-1.45004,-1.44634,-1.45349,-1.46112,-1.46777,-1.47351,-1.47859,-1.48351,-1.49078,-1.49109,-1.50021,-1.50404,-1.51121,-1.51456,-1.52089,-1.52658,-1.53161,-1.53672,-1.54422,-1.54789,-1.55445,-1.56284,-1.56246,-1.57069,-1.57851,-1.58292,-1.58967,-1.59418,-1.60013,-1.60577,-1.61311,-1.61786,-1.62499,-1.63112,-1.63361,-1.64252,-1.64632,-1.65098,-1.6583,-1.65952,-1.66664,-1.674,-1.67809,-1.68709,-1.69301,-1.69921,-1.7022,-1.70809,-1.7128,-1.71915,-1.7217,-1.72934,-1.73148,-1.73794,-1.74294,-1.74961,-1.7551,-1.75943,-1.76121,-1.76906,-1.77336,-1.77685,-1.78149,-1.78668,-1.78859,-1.79058,-1.79326,-1.7957,-1.80067,-1.80306,-1.80783,-1.81462,-1.81618,-1.81837,-1.82434,-1.82914,-1.83601,-1.84078,-1.84202,-1.84868,-1.85449,-1.86207,-1.86879,-1.87499,-1.88188,-1.88794,-1.89911,-1.90819,-1.91743,-1.92605,-1.93473,-1.94382,-1.94971,-1.96136,-1.97214,-1.98049,-1.98974,-1.99668,-2.0081,-2.01717,-2.02556,-2.03541,-2.04407,-2.05472,-2.06338,-2.07224,-2.07922,-2.09009,-2.09506,-2.10474,-2.11228,-2.11841,-2.12784,-2.13467,-2.14373,-2.15203,-2.15794,-2.16652,-2.17522,-2.1815,-2.19199,-2.19824,-2.20975,-2.22115,-2.22412,-2.23256,-2.24386,-2.25168,-2.25682,-2.26791,-2.27856,-2.28343,-2.29502,-2.29968,-2.31133,-2.31531,-2.32582,-2.33636,-2.34231,-2.3528,-2.36426,-2.3685,-2.37741,-2.38651,-2.39277,-2.40172,-2.41186,-2.42203,-2.42661,-2.43536,-2.44423,-2.45043,-2.45737,-2.4669,-2.47644,-2.47957,-2.48815,-2.49338,-2.50397,-2.51059,-2.51413,-2.52404,-2.53207,-2.53561,-2.54371,-2.55226,-2.56062,-2.56661,-2.57634,-2.58339,-2.59435,-2.60491,-2.60974,-2.6199,-2.63168,-2.64081,-2.65025,-2.65954,-2.67021,-2.6781,-2.68912,-2.70077,-2.71102,-2.72138,-2.73131,-2.74259,-2.75231,-2.76159,-2.77135,-2.78212,-2.79221,-2.79784,-2.80761,-2.81396,-2.82286,-2.8325,-2.84133,-2.84869,-2.85517,-2.86325,-2.88043,-2.8871,-2.89371,-2.90249,-2.9121,-2.91929,-2.93047,-2.93795,-2.94802,-2.95522,-2.9663,-2.97453,-2.98246,-2.99295,-2.99976,-3.01213,-3.02103,-3.03132,-3.03963,-3.04949,-3.06266,-3.06996,-3.0785,-3.08889,-3.09976,-3.10574,-3.11605,-3.12853,-3.13368,-3.14595,-3.15273,-3.16087,-3.16936,-3.17652,-3.18219,-3.19142,-3.1965,-3.20083,-3.20884,-3.21822,-3.22434,-3.23042,-3.23684,-3.24453,-3.25068,-3.25892,-3.26717,-3.27351,-3.27756,-3.28331,-3.29364,-3.29955,-3.30958,-3.31978,-3.32734,-3.33573,-3.34371,-3.3527,-3.36099,-3.36718,-3.37761,-3.38757,-3.39461,-3.40464,-3.41699,-3.42293,-3.43333,-3.44218,-3.44855,-3.45727,-3.46494,-3.4729,-3.48059,-3.49119,-3.49567,-3.50536,-3.51273,-3.51869,-3.52466,-3.53111,-3.53809,-3.54422,-3.54937,-3.55501,-3.55845,-3.56381,-3.56915,-3.57376,-3.57831,-3.58054,-3.58553,-3.5894,-3.5928,-3.60082,-3.60327,-3.60561,-3.61159,-3.61184,-3.6171,-3.61929,-3.62319,-3.62905,-3.63035,-3.63412,-3.63679,-3.64195,-3.64629,-3.64757,-3.64983,-3.65296,-3.6581,-3.65884,-3.66078,-3.66263,-3.66497,-3.66895,-3.67007,-3.67226,-3.67459,-3.67704,-3.67883,-3.68163,-3.68302,-3.68627,-3.69125,-3.69322,-3.69495,-3.6994,-3.70277,-3.70521,-3.70806,-3.71002,-3.71154,-3.71265,-3.71677,-3.7171,-3.72113,-3.72096,-3.72075,-3.72207,-3.72347,-3.72363,-3.72508,-3.72612,-3.72693,-3.72566,-3.7282,-3.72772,-3.72676,-3.72775,-3.72877,-3.72972,-3.72759,-3.73036,-3.72725,-3.72765,-3.7252,-3.72937,-3.72979,-3.73145,-3.72926,-3.72591,-3.73355,-3.7286,-3.72843,-3.73214,-3.7331,-3.73341,-3.7321,-3.73287,-3.73819,-3.73977,-3.73645,-3.73772,-3.7406,-3.73669,-3.73713,-3.73855,-3.74002,-3.73975,-3.74325,-3.74093,-3.74031,-3.74103,-3.74072,-3.73425,-3.73513,-3.73615,-3.73354,-3.73113,-3.73229,-3.7299,-3.72827,-3.72855,-3.72407,-3.72414,-3.72403,-3.72169,-3.71909,-3.71651,-3.71938,-3.70975,-3.71314,-3.71501,-3.70473,-3.70367,-3.70282,-3.69946,-3.69574,-3.6949,-3.69363,-3.68808,-3.6865,-3.68653,-3.68191,-3.67922,-3.67955,-3.67888,-3.67703,-3.6753,-3.67727,-3.67948,-3.67808,-3.67789,-3.68087,-3.68367,-3.68082,-3.68636,-3.68684,-3.69138,-3.69742,-3.70264,-3.70669,-3.71136,-3.71184,-3.71524,-3.72292,-3.73103,-3.7358,-3.74573,-3.74942,-3.75949,-3.76519,-3.77253,-3.77664,-3.78674,-3.7907,-3.80599,-3.80927,-3.82227,-3.83058,-3.83283,-3.83778,-3.84363,-3.85117,-3.85236,-3.85847,-3.86179,-3.8681,-3.86886,-3.87153,-3.87468,-3.87471,-3.87699,-3.87882,-3.88164,-3.88277,-3.88308,-3.8808,-3.88086,-3.87699,-3.87741,-3.87023,-3.8717,-3.86637,-3.86975,-3.86312,-3.86125,-3.85543,-3.84951,-3.84613,-3.84296,-3.84229,-3.83358,-3.82983,-3.82322,-3.81887,-3.81874,-3.81236,-3.80714,-3.80252,-3.80227,-3.79805,-3.79319,-3.78789,-3.7865,-3.78574,-3.77818,-3.77593,-3.77404,-3.77314,-3.77329,-3.76702,-3.7616,-3.76835,-3.76174,-3.76057,-3.75795,-3.75711,-3.7536,-3.7517,-3.74988,-3.74428,-3.74672,-3.74317,-3.74235,-3.7418,-3.74245,-3.74101,-3.74212,-3.74254,-3.74144,-3.73998,-3.7366,-3.743,-3.74394,-3.74611,-3.74785,-3.75074,-3.75138,-3.75205,-3.75348,-3.75649,-3.75803,-3.75661,-3.75933,-3.76012,-3.76061,-3.76435,-3.76022,-3.76077,-3.76025,-3.7653,-3.76223,-3.76302,-3.76226,-3.76039,-3.76229,-3.76273,-3.75648,-3.76,-3.75908,-3.75626,-3.76142,-3.75548,-3.75154,-3.75189,-3.75196,-3.75304,-3.74832,-3.74805,-3.73836,-3.74025,-3.73934,-3.73282,-3.73041,-3.72964,-3.72601,-3.72404,-3.72317,-3.72109,-3.71755,-3.71466,-3.71253,-3.70959,-3.70727,-3.70616,-3.70042,-3.6994,-3.69462,-3.69407,-3.69421,-3.68932,-3.68118,-3.67788,-3.67667,-3.67887,-3.67547,-3.66869,-3.67264,-3.66823,-3.66869,-3.65854,-3.66852,-3.65941,-3.65216,-3.65179,-3.64957,-3.6512,-3.65072,-3.64463,-3.64503,-3.6468,-3.64572,-3.64225,-3.63902,-3.63276,-3.6305,-3.62509,-3.61533,-3.61456,-3.61059,-3.60531,-3.60222,-3.59348,-3.58916,-3.58324,-3.57959,-3.57118,-3.56472,-3.55605,-3.54832,-3.54172,-3.52934,-3.52593,-3.51918,-3.50744,-3.50323,-3.50063,-3.48952,-3.48228,-3.47366,-3.47279,-3.46314,-3.45745,-3.44818,-3.44645,-3.43827,-3.42598,-3.41986,-3.42211,-3.41423,-3.41295,-3.41086,-3.40044,-3.39592,-3.38798,-3.38742,-3.38899,-3.38731,-3.37932,-3.37901,-3.38367,-3.37929,-3.38472,-3.3669,-3.3741,-3.36067,-3.34262,-3.38773,-3.33979,-3.40209,-3.38664,-3.42939,-3.34134,-3.36319,-3.40191,-3.33287,-3.36884,-3.36635,-3.32483,-3.42419,-3.36814,-3.35195,-3.39817,-3.39814,-3.39539,-3.34684,-3.37385,-3.37384,-3.36319,-3.37535,-3.34991,-3.38208,-3.36359,-3.37998,-3.37656,-3.37,-3.41133,-3.37372,-3.34815,-3.43611,-3.35606,-3.35055,-3.3808,-3.36528,-3.38013,-3.35019,-3.37541,-3.43722,-3.37173,-3.34504,-3.33027,-3.38447,-3.34095,-3.3346,-3.40833,-3.39076,-3.36183,-3.41968,-3.38641,-3.41193,-3.40617,-3.41851,-3.40163,-3.41408,-3.37927};

Eigen::Quaterniond GlobalG2oMap::normAndDToQuat(double d, Eigen::Vector3d norm) {
    Eigen::Quaterniond res;
    norm.normalize();
    res.x() = norm[0];
    res.y() = norm[1];
    res.z() = norm[2];
    res.w() = -d;

    g2o::VertexPlaneQuat::normalizeAndUnify(res);
    return res;
}

GlobalG2oMap::GlobalG2oMap() {}

void GlobalG2oMap::addNewFrames(vector<Plane> &planes) {
    if (!initialized) {
        initializeFirstFrame(planes);
        initialized = true;
    } else {
        addNextFramePlanes(planes);
    }
}

void GlobalG2oMap::initializeFirstFrame(vector<Plane> &planes) {
    positionNumber = 0;

    g2o::BlockSolverX::LinearSolverType *linearSolverMin = new g2o::LinearSolverPCG<g2o::BlockSolverX::PoseMatrixType>();
    g2o::BlockSolverX *solverMin = new g2o::BlockSolverX(linearSolverMin);
    g2o::OptimizationAlgorithmLevenberg *algorithmMin = new g2o::OptimizationAlgorithmLevenberg(solverMin);
    optimizerMin.setAlgorithm(algorithmMin);

    //set init camera pose
    g2o::VertexSE3Quat *curV = new g2o::VertexSE3Quat();
    Vector3d trans(0.0, 0.0, 0.0);
    Quaterniond q;
    q.setIdentity();
    g2o::SE3Quat poseSE3Quat(q, trans);
    curV->setEstimate(poseSE3Quat);
//    cout<<"Adding VertexSE3Quat id = " << CAMERA_POS_INDEXES_SHIFT + positionNumber <<endl;
    curV->setId(CAMERA_POS_INDEXES_SHIFT + positionNumber);
    curV->setFixed(true);

    optimizerMin.addVertex(curV);

    for (Plane &plane : planes) {

        tuple<long, bool, Plane> status = GlobalMap::getInstance().addPlaneToMap(plane, lastPosOrient, positionNumber);

        if (get<1>(status)) {
            //add planes to graph
            g2o::VertexPlaneQuat *curV2 = new g2o::VertexPlaneQuat();
            curV2->setEstimate(normAndDToQuat(plane.getD(), plane.getPlaneNormalVec()));
            cout<<"Adding VertexPlaneQuat id = " << get<0>(status) <<endl;
            curV2->setId((int) get<0>(status));
            optimizerMin.addVertex(curV2);

            //add edge to graph
            g2o::EdgeSE3Plane *curEdge = new g2o::EdgeSE3Plane();
            curEdge->setVertex(0, optimizerMin.vertex(CAMERA_POS_INDEXES_SHIFT + positionNumber));
            curEdge->setVertex(1, optimizerMin.vertex((int) get<0>(status)));

            curEdge->setMeasurement(normAndDToQuat(plane.getD(), plane.getPlaneNormalVec()));

            curEdge->setInformation(Eigen::Matrix<double, 3, 3>::Identity());

            optimizerMin.addEdge(curEdge);
        }
    }
}

void GlobalG2oMap::addNextFramePlanes(vector<Plane> &planes) {
    positionNumber++; // increment camera position number

    //set init camera pose
    g2o::VertexSE3Quat *curV = new g2o::VertexSE3Quat();
    Vector3d trans(lastPosOrient.getPosition());
    Quaterniond res(lastPosOrient.getQuaternion());
    g2o::SE3Quat poseSE3Quat(res, trans);
    curV->setEstimate(poseSE3Quat);
    //cout<<"Adding VertexSE3Quat id = " << CAMERA_POS_INDEXES_SHIFT + positionNumber <<endl;
    curV->setId(CAMERA_POS_INDEXES_SHIFT + positionNumber);

    optimizerMin.addVertex(curV);

    MatchPlanesG2o matchPlanesG2o;
    matchPlanesG2o.setLastPosOrient(lastPosOrient);
    vector<Plane> globalPlanes = GlobalMap::getInstance().getGlobalMapVector();
    vector<pair<Plane, Plane>> matchedPlanes = matchPlanesG2o.getSimilarPlanes(globalPlanes, planes);
    vector<Plane> unmatchedPlanes = matchPlanesG2o.getUnmatchedPlanes();

    for (auto &planePair : matchedPlanes) {
        //add edge to graph
        g2o::EdgeSE3Plane *curEdge = new g2o::EdgeSE3Plane();
        curEdge->setVertex(0, optimizerMin.vertex(CAMERA_POS_INDEXES_SHIFT + positionNumber));
        curEdge->setVertex(1, optimizerMin.vertex(planePair.first.getId()));

        curEdge->setMeasurement(normAndDToQuat(planePair.second.getD(), planePair.second.getPlaneNormalVec()));

        curEdge->setInformation(Eigen::Matrix<double, 3, 3>::Identity());

        optimizerMin.addEdge(curEdge);
    }


    for(auto &plane : unmatchedPlanes) {
        tuple<long, bool, Plane> status = GlobalMap::getInstance().addPlaneToMap(plane, lastPosOrient, positionNumber);

        g2o::VertexPlaneQuat *curV2 = new g2o::VertexPlaneQuat();
        curV2->setEstimate(normAndDToQuat(get<2>(status).getD(), get<2>(status).getPlaneNormalVec()));
        //cout<<"Adding VertexPlaneQuat id = " << get<0>(status) <<endl;
        curV2->setId((int) get<0>(status));
        optimizerMin.addVertex(curV2);

        //add edge to graph
        g2o::EdgeSE3Plane *curEdge = new g2o::EdgeSE3Plane();
        curEdge->setVertex(0, optimizerMin.vertex(CAMERA_POS_INDEXES_SHIFT + positionNumber));
        curEdge->setVertex(1, optimizerMin.vertex((int) get<0>(status)));

        curEdge->setMeasurement(normAndDToQuat(plane.getD(), plane.getPlaneNormalVec()));

        curEdge->setInformation(Eigen::Matrix<double, 3, 3>::Identity());

        optimizerMin.addEdge(curEdge);
    }

    optimizerMin.setVerbose(false);
    optimizerMin.initializeOptimization();
    optimizerMin.optimize(100);

    g2o::VertexSE3Quat *curPoseVert = static_cast<g2o::VertexSE3Quat *>(optimizerMin.vertex(
            CAMERA_POS_INDEXES_SHIFT + positionNumber));
    g2o::Vector7d poseVect = curPoseVert->estimate().toVector();
    lastPosOrient.setPosOrient(poseVect);

    for (int i = 0; i < GlobalMap::getInstance().getCurrentId(); ++i) {
        g2o::VertexPlaneQuat *curPlaneVert = static_cast<g2o::VertexPlaneQuat *>(optimizerMin.vertex(i));
        Eigen::Quaterniond quaternion = curPlaneVert->estimate();
        Eigen::Vector3d normVec(quaternion.x(), quaternion.y(), quaternion.z());
        double norm = normVec.norm();
        normVec.normalize();
        Plane plane(-quaternion.w() / norm, normVec);
        plane.setId(curPlaneVert->id());
        GlobalMap::getInstance().updatePlane(plane);
    }
    string s = "output" + to_string(positionNumber) + ".g2o";
    optimizerMin.save(s.c_str());
}

const PosOrient &GlobalG2oMap::getLastPosOrient() const {
    return lastPosOrient;
}

void GlobalG2oMap::saveTrajectoryToFile() {
    ofstream trajectoryFile;
    trajectoryFile.open("trajectories/trajectory.txt", ios::trunc | ios::out);
    for (int i = 0; i <= positionNumber; ++i){
        g2o::VertexSE3Quat *curPoseVert = static_cast<g2o::VertexSE3Quat *>(optimizerMin.vertex(
                CAMERA_POS_INDEXES_SHIFT + i));
        g2o::Vector7d poseVect = curPoseVert->estimate().toVector();
        trajectoryFile << poseVect[0] << " " << poseVect[1] << " " << poseVect[2] << " " << poseVect[6] << " "
                       << poseVect[3] << " " << poseVect[4] << " " << poseVect[5] << "\n";
    }
    trajectoryFile.close();
}
